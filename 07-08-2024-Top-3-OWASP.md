# Understanding Common Web Security Threats

This article explores three prevalent web security threats: injection attacks, cross-site scripting (XSS), and cross-site request forgery (CSRF). For each threat, we discuss examples, attack mechanisms, and prevention methods.

---

## 1. Injection Attacks

Injection attacks involve injecting malicious data into an application, often through user input fields, to exploit vulnerabilities in data processing.

### 1.1 SQL Injection
SQL injection occurs when an attacker manipulates an application's SQL queries to gain unauthorized access to a database.

#### Examples:
1. Unsanitized input fields can allow attackers to add malicious SQL code.
2. Crafting input to exploit dynamic SQL queries.

#### Prevention Methods:
1. **Input Sanitization**: Remove special characters (e.g., single quotes) from user input.
2. **Bind Parameters**:
   - Use placeholders in SQL queries to prevent direct injection.
   - Database execution plans are reused when bind parameters are used, ensuring they can't be altered to execute malicious SQL.

---

## 2. Cross-Site Scripting (XSS)

XSS attacks exploit vulnerabilities in web applications to execute malicious scripts in a user's browser.

### 2.1 Types of XSS Attacks

#### 2.1.1 Stored XSS
- **Mechanism**: Malicious scripts are stored in the database and executed when a user views the affected page.
- **Example**: An input form doesn't sanitize inputs, allowing the attacker to store a `<script>` tag in the database. When the user views the stored comment, the script executes in their browser.

#### 2.1.2 Reflected XSS
- **Mechanism**: Malicious scripts are included in a URL or input and executed when the page renders the content.
- **Example**: A search query is reflected in the webpage without sanitization. Entering `q?searchquery="<script>malicious code</script>"` results in the script being executed when the page loads.

### 2.2 Prevention Methods:
1. **Sanitize Input Fields**: Filter out harmful characters and scripts from inputs.
2. **Sanitize Stored HTML**: Ensure stored data does not contain executable scripts.

---

## 3. Cross-Site Request Forgery (CSRF)

CSRF exploits an authenticated user's session to perform unauthorized actions on their behalf.

### 3.1 Mechanism:
1. The attacker tricks the victim into submitting a malicious request, typically via a hidden form or link.
2. **Example**:
   - A malicious blog contains a hidden form that sends a POST request to a bank server, transferring money to the attacker.
   - If the victim is logged into their bank in another tab, the request is validated using their active session and executed.

### 3.2 Prevention Methods:
1. **CSRF Tokens**:
   - Generate a unique CSRF token for each legitimate form request.
   - Validate the token on the server side to ensure it matches the submitted request.