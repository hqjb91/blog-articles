# Top 3 OWASP

OWASP Foundation is a non profit foundation that promotes application security. It routinely publishes the OWASP Top Ten annually.

This article explores three prevalent web security threats frequently appearing in OWASP Top Ten: injection attacks, cross-site scripting (XSS), and cross-site request forgery (CSRF).

---

## Injection Attacks

Injection attacks involve injecting malicious data into an application, often through user input fields, to exploit vulnerabilities.

### SQL Injection
SQL injection occurs when an attacker manipulates an application's SQL queries.

#### Examples:
1. Unsanitized input fields can allow attackers to add malicious SQL code which will be ran by the application itself.

#### Prevention Methods:
1. Input Sanitization: Remove special characters (e.g. single quotes) from user input.
2. Bind Parameters: Prevent by using bind parameters, databases cache execution plans if the SQL queries are exactly the same. Bind parameters are just place holders and the execution plans are reused. If there are changes to the execution plans i.e. the bind parameters are not just replacing the values and cannot change the execution plan hence preventing SQL injection.

---

## Cross-Site Scripting (XSS)

XSS attacks exploit vulnerabilities in web applications to execute malicious scripts in a user's browser.

### Types of XSS Attacks

#### Stored XSS
- Mechanism: Malicious scripts are stored in the database and executed when a user views the affected page.
- Example: An input form doesn't sanitize inputs, allowing the attacker to store a `<script>` tag in the database. When the user views the stored comment, the script executes in their browser.

#### 2.1.2 Reflected XSS
- Mechanism: Malicious scripts are included in a URL or input and executed when the page renders the content.
- Example: A search query is reflected in the webpage without sanitization. Entering `q?searchquery="<script>malicious code</script>"` results in the script being executed when the page loads.

### Prevention Methods:
1. Sanitize Input Fields: Filter out harmful characters and scripts from inputs.
2. Sanitize Stored HTML: Ensure stored data does not contain executable scripts.

---

## Cross-Site Request Forgery (CSRF)

CSRF exploits an authenticated user's session to perform unauthorized actions on their behalf.

### Mechanism:
1. The attacker tricks the victim into submitting a malicious request, typically via a hidden form or link.
2. Example:
   - A malicious blog contains a hidden form that sends a POST request to a bank server, transferring money to the attacker.
   - If the victim is logged into their bank in another tab, the request is validated using their active session and executed.

### Prevention Methods:
1. CSRF Tokens:
   - Generate a unique CSRF token for each legitimate form request.
   - Validate the token on the server side to ensure it matches the submitted request.